<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>scroll.me</title> 
  <meta name="author" content="Jordan Cazamias | https://github.com/jaycaz">
  <style type="text/css">
    html {
      height: 100%;
    }
    body {
      height: 100%;
    }
    #toolbar{
      margin: 20px;
    }
    #viz {
      height: 95%;
    }
    #npage-slider {
      ui-slider-range
    }
    #npage-handle {
      width: 3em;
      height: 1.6em;
      top: 50%;
      margin-top: -.8em;
      text-align: center;
      line-height: 1.6em;
    }
  }
  </style>
</head>

<body>
  <div id="toolbar">
    <div id="npage-label"></div>
    <div id="npage-slider">
      <div id="npage-handle" class="ui-slider-handle"></div>
    </div>
  </div>
  <div id="viz"></div>
</body>


<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script>

var pages = [];
var npages = 0;
$( function() {
  var handle = $( "#npage-handle" );
  $( "#npage-slider" ).slider({
    min: 1,
    max: 1000,
    create: function() {
      handle.text( $( this ).slider( "value" ) );
      setNpages($(this).slider("value"));
    },
    slide: function( event, ui ) {
      handle.text( ui.value );
      setNpages(ui.value);
      update();
    }
  });
});

var svg = d3.select("#viz")
  .append("svg")
  .attr("width", "100%")
  .attr("height", "100%")
  .style("padding", "10px");

function setNpages(n)
{
  // Depending on new value of npages, push/pop new pages to end
  if(n > npages)
  {
    for(var i = 0; i < (n-npages); i++)
    {
      pages.push({})
    }
  }
  else if(n < npages)
  {
    for(var i = 0; i < (npages-n); i++)
    {
      pages.pop();
    }
  }
  npages = n;
}

function update() {
  // svg.selectAll('rect').remove();
  // for(var i = 0; i < npages; i++)
  // {
  //   svg.append('rect')
  //     .attr('x', (i/30) * 30)
  //     .attr('y', parseInt(i%30) * 50)
  //     .attr('width', 25)
  //     .attr('height', 37)
  //     .attr('rx', 2)
  //     .attr('ry', 2)
  //     .style('stroke', '#000')
  //     .style('fill', '#e2e3e3');
  // }

  var selection = svg.selectAll('rect')
    .data(pages);

  selection.enter()
    .append('rect')
    .attr('x', function(d,i) { return parseInt(i/30) * 30; })
    .attr('y', function(d,i) { return parseInt(i%30) * 50; })
    .attr('width', 25)
    .attr('height', 37)
    .attr('rx', 2)
    .attr('ry', 2)
    .style('stroke', '#000')
    .style('fill', '#e2e3e3');

  selection.exit().remove();
}
var bb = svg.node().getBBox();

</script>
</body>
</html>